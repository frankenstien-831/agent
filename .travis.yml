dist: xenial
sudo: required
language: node_js
node_js: node

cache: npm

# will run `npm install` automatically here

before_script:
  - git clone https://github.com/oceanprotocol/barge
  - cd barge
  - export KEEPER_OWNER_ROLE_ADDRESS="0xe2DD09d719Da89e5a3D0F2549c7E24566e947260"
  - rm -rf "${HOME}/.ocean/keeper-contracts/artifacts"
  - bash -x start_ocean.sh --no-commons --no-dashboard 2>&1 > start_ocean.log &
  - cd ..
  - cp .env.example .env
  - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
  - chmod +x ./cc-test-reporter
  - './cc-test-reporter before-build'

script:
  - ./scripts/keeper.sh
  - npm test
  - './cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT'
  - npm run build

notifications:
  email: false
